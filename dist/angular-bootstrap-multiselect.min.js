"use strict";!function(){var e=angular.module("btorfs.multiselect",["btorfs.multiselect.templates"]);e.getRecursiveProperty=function(e,t){return t.split(".").reduce((function(e,t){return e?e[t]:null}),e)},e.directive("multiselect",["$filter","$document","$log",function(t,n,s){return{restrict:"AE",scope:{options:"=",displayProp:"@",idProp:"@",searchLimit:"=?",selectionLimit:"=?",showSelectAll:"=?",showUnselectAll:"=?",showSearch:"=?",searchFilter:"=?",disabled:"=?ngDisabled",labels:"=?",classesBtn:"=?",showTooltip:"=?",placeholder:"@?"},require:"ngModel",templateUrl:"multiselect.html",controller:["$scope",function(e){angular.isUndefined(e.classesBtn)&&(e.classesBtn=["btn-block","btn-default"])}],link:{post:function(t,l,i,o){t.selectionLimit=t.selectionLimit||0,t.searchLimit=t.searchLimit||25,t.searchFilter="",t.resolvedOptions=[],"function"!=typeof t.options&&(t.resolvedOptions=t.options),void 0!==i.disabled&&(t.disabled=!0);var c=function(e){l[0].contains(e.target)||t.$apply((function(){t.open=!1}))};n.on("click",c);var r=function(){(t.resolvedOptions||t.options)&&(o.$viewValue?(t.selectedOptions=(t.resolvedOptions||t.options).filter((function(e){for(var n=t.getId(e),s=0;s<o.$viewValue.length;s++){if(n===t.getId(o.$viewValue[s]))return!0}return!1})),t.unselectedOptions=(t.resolvedOptions||t.options).filter((function(e){return t.selectedOptions.indexOf(e)<0}))):(t.selectedOptions&&(t.selectedOptions=[]),t.unselectedOptions=(t.resolvedOptions||t.options).slice()),t.getButtonText())};t.toggleDropdown=function(){t.open=!t.open,t.resolvedOptions=t.options,r()},o.$render=function(){r()},o.$viewChangeListeners.push((function(){r()})),o.$isEmpty=function(e){return!e||0===e.length};var a=t.$watch("selectedOptions",(function(){var e=angular.copy(t.selectedOptions);e&&(t.idProp?o.$setViewValue(e&&e.map((function(e){return e[t.idProp]}))):o.$setViewValue(e))}),!0);t.$on("$destroy",(function(){n.off("click",c),a&&a()})),t.getButtonText=function(){if(t.selectedOptions&&1===t.selectedOptions.length)t.buttonText=t.getDisplay(t.selectedOptions[0]);else if(t.selectedOptions&&t.selectedOptions.length>1){var e=angular.isDefined(t.selectedOptions)?t.selectedOptions.length:0;t.buttonText=0===e?t.labels&&t.labels.select?t.labels.select:"Select":"".concat(e," ").concat(t.labels&&t.labels.itemsSelected?t.labels.itemsSelected:"selected")}else t.buttonText=t.labels&&t.labels.select?t.labels.select:"Select"},t.selectAll=function(){t.selectedOptions=t.resolvedOptions.slice().filter((function(e){return""!==t.getId(e)})),t.unselectedOptions=[]},t.unselectAll=function(){t.selectedOptions=[],t.unselectedOptions=t.resolvedOptions.slice()},t.toggleItem=function(e){void 0===t.selectedOptions&&(t.selectedOptions=[]);var n=t.selectedOptions.indexOf(e),s=-1!==n;if(s)t.unselectedOptions.push(t.selectedOptions[n]),t.selectedOptions.splice(n,1);else if(!s&&(0===t.selectionLimit||t.selectedOptions.length<t.selectionLimit)){var l=t.unselectedOptions.indexOf(e);t.unselectedOptions.splice(l,1),t.selectedOptions.push(e)}},t.getId=function(n){return angular.isString(n)?n:angular.isObject(n)?t.idProp?e.getRecursiveProperty(n,t.idProp):(s.error("Multiselect: when using objects as model, a idProp value is mandatory."),""):n},t.getDisplay=function(n){return angular.isString(n)?n:angular.isObject(n)?t.displayProp?e.getRecursiveProperty(n,t.displayProp):(s.error("Multiselect: when using objects as model, a displayProp value is mandatory."),""):n},t.isSelected=function(e){if(!t.selectedOptions)return!1;for(var n=t.getId(e),s=0;s<t.selectedOptions.length;s++){var l=t.selectedOptions[s];if(t.getId(l)===n)return!0}return!1},t.updateOptions=function(){"function"==typeof t.options&&t.options().then((function(e){t.resolvedOptions=e,r()}))},t.search=function(){var e=0;return function(n){if(e>t.searchLimit)return!1;var s=t.getDisplay(n);if(s){var l=s.toLowerCase().indexOf(t.searchFilter.toLowerCase())>-1;return l&&(e+=1),l}}},t.$watch("options",r)}}}}])}(),function(e){try{e=angular.module("btorfs.multiselect.templates")}catch(t){e=angular.module("btorfs.multiselect.templates",[])}e.run(["$templateCache",function(e){e.put("multiselect.html","<div class='btn-group' style='width: 100%'>\n    <button type='button' class='btn dropdown-toggle' ng-class='classesBtn' ng-click='toggleDropdown()' ng-disabled='disabled' style='white-space: nowrap; overflow-x: hidden; text-overflow: ellipsis;'>\n        {{buttonText}}&nbsp;<span class='caret'></span>\n    </button>\n    <ul class='dropdown-menu dropdown-menu-form'\n        ng-style=\"{display: open ? 'block' : 'none'}\" style='width: 100%; overflow-x: auto'>\n\n        <li ng-show='showSelectAll'>\n            <a ng-click='selectAll()' href=''>\n                <span class='fa fa-check'></span> {{labels.selectAll || 'Select All'}}\n            </a>\n        </li>\n        <li ng-show='showUnselectAll'>\n            <a ng-click='unselectAll()' href=''>\n                <span class='fa fa-times'></span> {{labels.unselectAll || 'Unselect All'}}\n            </a>\n        </li>\n        <li ng-show='(showSelectAll || showUnselectAll)'\n            class='divider'>\n        </li>\n\n        <li role='presentation' ng-repeat='option in selectedOptions' class='active'>\n            <a class='item-selected' href='' title=\"{{showTooltip ? getDisplay(option) : ''}}\" ng-click='toggleItem(option); $event.stopPropagation()' style='overflow-x: hidden;text-overflow: ellipsis'>\n                <span class='fa fa-times'></span>\n                {{getDisplay(option)}}\n            </a>\n        </li>\n        <li ng-show='selectedOptions.length > 0' class='divider'></li>\n\n        <li ng-show='showSearch'>\n            <div class='dropdown-header'>\n                <input type='text' class='form-control input-sm' style='width: 100%;'\n                       ng-model='searchFilter' placeholder=\"{{labels.search || 'Search...'}}\" ng-change='updateOptions()'/>\n            </div>\n        </li>\n\n        <li ng-show='showSearch' class='divider'></li>\n        <li role='presentation' ng-repeat='option in unselectedOptions | filter:search() | limitTo: searchLimit'\n            ng-if='!isSelected(option)'\n            ng-class='{disabled : selectionLimit && selectedOptions.length >= selectionLimit}'>\n            <a class='item-unselected' href='' title=\"{{showTooltip ? getDisplay(option) : ''}}\" ng-click='toggleItem(option); $event.stopPropagation()' style='overflow-x: hidden;text-overflow: ellipsis'>\n                {{getDisplay(option)}}\n            </a>\n        </li>\n\n        <li class='divider' ng-show='selectionLimit > 1'></li>\n        <li role='presentation' ng-show='selectionLimit > 1'>\n            <a>{{selectedOptions.length || 0}} / {{selectionLimit}} {{labels.itemsSelected || 'selected'}}</a>\n        </li>\n\n    </ul>\n</div>\n")}])}();